<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/button.css">
</head>
<body>
    <script type="module">
        import * as o3h from "/api/o3h.js";
        const runtime = o3h.Instance;

        // Global variables
        let cameraComponent;

        // Module functions
        async function setupModule() {
            runtime.adjustViewport("device-width", "device-height");
            
            // Camera component configuration
            const cameraConfig = new o3h.CameraComponentConfig();
            cameraConfig.resolutionScale = o3h.CameraResolutionScale.Full; // Full resolution
            cameraConfig.cameraType = o3h.CameraType.FrontFacing;
            
            // Creating a full-screen camera layout
            const componentConfig = {"main": cameraConfig};
            const layout = await runtime.createLayout("Full Screen", componentConfig);
            
            // Make the layout active
            await layout.show();

            // Get the camera component and set as a global variable
            cameraComponent = layout.getComponent("main");
        }

        async function startModule() {
            // Start recording the camera
            cameraComponent.startRecording();
            
            // Wait for 10 seconds
            await wait(60000);
            
            // Stop the camera recording and get the video asset
            const videoAsset = await cameraComponent.stopRecording();
            
            // Add the video asset to the module output
            const assetManager = runtime.getAssetManager();
            assetManager.addToOutput("recording", videoAsset);
            
            // Complete the module
            runtime.completeModule({"score": 0});
        }

        // Setup module then display the module to the player
        setupModule().then(() => runtime.ready(startModule));

        // Utility functions
        function wait(milliseconds) {
            return new Promise(resolve => setTimeout(resolve, milliseconds));
        }        
    </script>
    <br>
    <br>
    <br>
    <br>
    <div class="main"></div>
    <div class="container">
        <span id = "timer" > Timer: 60</span>
        <button id="button">Click</button>
        <div id="score">Score: 0</div>
    </div>
    <script src="/button.js"></script>
</body>
</html>